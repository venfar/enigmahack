"""
База знаний для генерации ответов
На основе документов Хакатон 2026 Д1, Д2, Д3
"""

KNOWLEDGE_BASE = {
    # =========================================================================
    # ОБЩАЯ ИНФОРМАЦИЯ
    # =========================================================================
    "company": {
        "name": "ООО «ЭРИС»",
        "website": "https://eriskip.com/ru/products",
        "support_email": "support@eris.ru",
        "docs_email": "docs@eris.ru",
        "support_phone": "+7 (800) XXX-XX-XX"
    },
    
    # =========================================================================
    # ДОКУМЕНТАЦИЯ
    # =========================================================================
    "documentation": {
        "url": "https://eriskip.com/ru/products",
        "description": "Актуальные руководства по эксплуатации газоанализаторов находятся в открытом доступе на официальном сайте ООО «ЭРИС» в разделе продукции",
        "includes": [
            "Руководства по эксплуатации (РЭ)",
            "Паспорта изделий",
            "Сертификаты (ATEX, IECEx, Росстандарт, ТР ТС)",
            "Свидетельства о поверке",
            "Методики поверки (МП)",
            "Схемы подключения",
            "Перечни запасных частей (ЗИП)"
        ]
    },
    
    # =========================================================================
    # КАЛИБРОВКА / ПОВЕРКА
    # =========================================================================
    "calibration": {
        "interval": "12 месяцев",
        "description": "Межповерочный интервал для всех газоанализаторов ЭРИС составляет 12 месяцев согласно свидетельству о типе средства измерений",
        "gases": {
            "CH4": "Метан — для датчиков CH4",
            "C3H8": "Пропан — для датчиков C3H8",
            "O2": "Кислород — для датчиков O2",
            "CO": "Угарный газ — для датчиков CO"
        },
        "partners": [
            "ООО «МетроСервис» (г. Москва)",
            "ЗАО «ГазАнализ» (г. Санкт-Петербург)",
            "Региональный центр ЦСМ"
        ]
    },
    
    # =========================================================================
    # ПОДКЛЮЧЕНИЕ
    # =========================================================================
    "connection": {
        "interfaces": [
            "RS-485 (Modbus RTU) — для интеграции с АСУ ТП",
            "4-20 мА — аналоговый выход",
            "Релейные выходы — для сигнализации"
        ],
        "modbus_settings": {
            "baud_rate": "9600",
            "parity": "None",
            "data_bits": "8",
            "stop_bits": "1",
            "address": "1 (настраивается)"
        },
        "rs485_max_length": "1200 метров",
        "recommendations": [
            "Используйте экранированный кабель (витая пара)",
            "Установите termination резисторы (120 Ом) на концах линии",
            "Избегайте прокладки рядом с силовыми кабелями",
            "Проверьте заземление экрана"
        ]
    },
    
    # =========================================================================
    # DGS BLE ANDROID
    # =========================================================================
    "dgs_ble": {
        "description": "Приложение DGS BLE для Android для подключения к приборам по Bluetooth",
        "required_data": [
            "ФИО",
            "Должность",
            "Наименование предприятия",
            "Контактный телефон",
            "ID устройства"
        ],
        "processing_time": "1 рабочий день"
    },
    
    # =========================================================================
    # ИСТОРИЯ РЕШЕНИЙ (из кейса Д1, Д2, Д3)
    # =========================================================================
    "solutions": [
        {
            "problem": "Ложные тревоги из-за конденсата при переменной температуре",
            "solution": "Установите влагозащитный кожух, проверьте условия эксплуатации (температура, влажность), выполните калибровку нулевого значения",
            "category": "неисправность"
        },
        {
            "problem": "Устройства не подключаются к ПК ЭРИС 210",
            "solution": "Проверьте целостность кабелей соединения, убедитесь что драйверы установлены корректно, проверьте COM-порт в диспетчере устройств, попробуйте подключить устройство напрямую (без USB-хаба)",
            "category": "неисправность"
        },
        {
            "problem": "Запрос сертификатов ATEX, IECEx, Росстандарт",
            "solution": "Сертификаты доступны в разделе «Документация» на сайте https://eriskip.com/ru/products или можно запросить на docs@eris.ru",
            "category": "документация"
        },
        {
            "problem": "Диапазон рабочих температур ДГС230 с суффиксом W00",
            "solution": "Для версии ДГС230/IR-G20 с суффиксом W00 расширенный диапазон рабочих температур: –50…+60 °C. Подробная информация в паспорте прибора или на сайте",
            "category": "документация"
        },
        {
            "problem": "Схема подключения к Siemens S7-1200 по Modbus RTU",
            "solution": "Используйте файл GSD/EDS из раздела «Документация», настройки Modbus RTU: 9600, None, 8, 1, адрес устройства 1",
            "category": "подключение"
        },
        {
            "problem": "Плохая связь по RS-485, требуется перезагрузка шкафа управления",
            "solution": "Проверьте termination резисторы (120 Ом), заземление экрана, отсутствие помех от силовых кабелей, длину линии (макс. 1200 м)",
            "category": "неисправность"
        },
        {
            "problem": "Запрос пароля для DGS BLE Android",
            "solution": "Запросите у клиента: ФИО, должность, наименование предприятия, контактный телефон, ID устройства. Срок обработки: 1 рабочий день",
            "category": "dgs_ble"
        }
    ]
}

# Промпт для LLM
GENERATION_PROMPT = """Ты — специалист службы технической поддержки ООО «ЭРИС».
Твоя задача — составить профессиональный ответ клиенту на основе предоставленной информации.

Требования к ответу:
1. Обращайся к клиенту по имени (если указано)
2. Используй вежливый, профессиональный тон
3. Включи конкретные рекомендации из базы знаний
4. Добавь контактную информацию для связи
5. Если вопрос требует дополнительной информации — запроси её
6. Пиши на русском языке
7. Ответ должен быть полезным и конкретным

Контекст из базы знаний:
{context}

Данные клиента:
- ФИО: {fio}
- Организация: {object_name}
- Телефон: {phone}
- Email: {email}
- Прибор: {device_type}
- Категория вопроса: {category}
- Тональность: {sentiment}

Суть вопроса: {description}

Составь ответ на русском языке:"""